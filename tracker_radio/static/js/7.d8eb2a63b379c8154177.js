webpackJsonp([7],{Rwbn:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("woOf"),i=e.n(s),n=e("mtWM"),r=e.n(n),o=e("H33K"),c=e("iwwE"),l=e("kxiW"),d=e.n(l),u=e("TPW+"),k={data:function(){return{tracks:[],headers:[{text:"Title",align:"left",sortable:!0,class:"track-title",value:"title"},{text:"",sortable:!1,class:"track-play"},{text:"",sortable:!1,class:"track-edit"},{text:"",sortable:!1,class:"track-favourite"},{text:"Average Rating",align:"right",sortable:!0,value:"average_rating"}],playlists:[],isFavourites:{},loading:!1,noDataMessage:"Loading Tracks"}},props:{user:Object,artistId:Number},watch:{artistId:function(t,a){this.updateArtistTracks(t)},user:function(t,a){this.updateArtistTracks(t),this.updatePlaylists()}},mixins:[u.a],methods:{getArtistTracksFromBackend:function(){var t=this;if(this.loading=!0,this.artistId){var a="https://indigobeetle.pythonanywhere.com/api/artists/"+this.artistId+"/tracks";if(this.user){var e=this;this.user.getIdToken(!0).then(function(t){r.a.get(a,{headers:{Authorization:"bearer "+t}}).then(function(t){e.tracks=t.data,e.$emit("num-tracks",e.tracks.length),e.loading=!1}).catch(function(t){console.log(t),e.loading=!1})})}else r.a.get(a).then(function(a){t.tracks=a.data,t.$emit("num-tracks",t.tracks.length),t.loading=!1}).catch(function(a){console.log(a),t.loading=!1})}},onTrackChanged:function(t){var a=this;this.getSingleTrackFromBackend(t).then(function(e){var s=a.tracks.find(function(a){return a.id===t});s&&i()(s,e)}).catch(function(t){console.log(t)})},getPlaylistsFromBackend:function(){var t=this;this.user&&this.user.getIdToken(!0).then(function(a){r.a.get("https://indigobeetle.pythonanywhere.com/api/playlists",{headers:{Authorization:"bearer "+a}}).then(function(a){t.playlists=a.data}).catch(function(t){console.log(t)})})},getArtistTracks:function(){this.tracks=[],this.getArtistTracksFromBackend()},getPlaylists:function(){this.playlists=[],this.getPlaylistsFromBackend()},updateArtistTracks:function(t){this.getArtistTracksFromBackend()},updatePlaylists:function(){this.getPlaylistsFromBackend()},trackSelected:function(t,a){this.$router.push({name:"track",params:{id:t.id}})},onPlayTrack:function(t){this.$emit("play-track",t.id)},addTrackToPlaylist:function(t,a){var e="https://indigobeetle.pythonanywhere.com/api/playlists/"+a+"/tracks/"+t,s=d.a.auth().currentUser,i=this;s&&s.getIdToken(!0).then(function(s){i.$gtm.trackEvent({event:"playlist-add-track",action:"add-track",category:"Playlist",label:"Track Added to Playlist",track_id:t,playlist_id:a}),r.a.put(e,{},{headers:{Authorization:"bearer "+s}}).then(function(t){console.log(t)}).catch(function(t){console.log(t)})})},getTrackLocation:function(t){return"http://app.wetracker.xyz/#/loadsong?url="+encodeURI("https://modland.com/pub/modules/Fasttracker 2/"+t.location)}},components:{TrackRating:o.default,TrackFavourite:c.default},created:function(){this.getArtistTracks(),this.getPlaylists()}},h={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-layout",{attrs:{row:""}},[e("v-flex",{attrs:{sm12:""}},[e("v-card",[e("v-data-table",{staticClass:"elevation-1 tracks",attrs:{headers:t.headers,items:t.tracks,loading:t.loading,"no-data-text":t.noDataMessage},scopedSlots:t._u([{key:"items",fn:function(a){return[e("tr",{on:{click:function(e){t.trackSelected(a.item)}}},[e("td",{staticClass:"track-title"},[t._v(t._s(a.item.title))]),t._v(" "),e("td",{staticClass:"track-play"},[e("v-icon",{attrs:{large:""},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.onPlayTrack(a.item)}}},[t._v("play_arrow")])],1),t._v(" "),e("td",{staticClass:"track-edit"},[e("v-menu",{attrs:{bottom:"",left:""},nativeOn:{click:function(t){t.stopPropagation(),t.preventDefault()}}},[e("v-btn",{attrs:{slot:"activator",icon:""},slot:"activator"},[e("v-icon",[t._v("more_vert")])],1),t._v(" "),e("v-list",{attrs:{dense:""}},[e("v-menu",{attrs:{"offset-x":"","open-on-hover":""}},[e("v-list-tile",{attrs:{slot:"activator"},slot:"activator"},[e("v-list-tile-title",[t._v("Add to Playlist")]),t._v(" "),e("v-list-tile-action",{staticClass:"justify-end"},[e("v-icon",[t._v("play_arrow")])],1)],1),t._v(" "),e("v-list",{attrs:{dense:""}},t._l(t.playlists,function(s){return e("v-list-tile",{key:s.id,on:{click:function(e){t.addTrackToPlaylist(a.item.id,s.id)}}},[t._v("\n                          "+t._s(s.title)+"\n                      ")])}),1)],1),t._v(" "),e("v-list-tile",[e("a",{attrs:{href:t.getTrackLocation(a.item),target:"_blank"}},[t._v("\n                      Open in WeTracker\n                    ")])])],1)],1)],1),t._v(" "),e("td",{staticClass:"track-favourite"},[e("track-favourite",{attrs:{user:t.user,track:a.item},on:{"track-changed":function(a){t.onTrackChanged(a)}}})],1),t._v(" "),e("td",{staticClass:"track-rating"},[e("track-rating",{attrs:{user:t.user,track:a.item},on:{"track-changed":function(a){t.onTrackChanged(a)}}})],1)])]}}])},[e("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1)],1)],1)},staticRenderFns:[]};var g=e("VU/8")(k,h,!1,function(t){e("mdkp"),e("VERd")},"data-v-036a530e",null);a.default=g.exports},VERd:function(t,a){},mdkp:function(t,a){}});
//# sourceMappingURL=7.d8eb2a63b379c8154177.js.map